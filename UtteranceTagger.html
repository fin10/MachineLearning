<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>Utterance Tagger</title>
    <link rel="stylesheet" href="https://swisnl.github.io/jQuery-contextMenu/dist/jquery.contextMenu.css" type="text/css" />
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
	<script src="https://swisnl.github.io/jQuery-contextMenu/dist/jquery.contextMenu.js" type="text/javascript"></script>
	<script src="https://swisnl.github.io/jQuery-contextMenu/dist/jquery.ui.position.min.js" type="text/javascript"></script>
</head>

<body>
	<script>
	$(function() {
        $.contextMenu({
            selector: '.context-menu-one', 
            items: {
                "keyword": {name: "keyword"}
            }
        });

        $('.context-menu-one').on('click', function(e){
            console.log('clicked', this);
        })    
    });

	function onTextChanged() {
		var input = document.getElementById("utterance");
		var index = getSelectionEnd(input.value);
		var text = input.value.substring(0, index);
		console.log(index + ", " + text);
		if (text.endsWith("-")) {
			var text = text.toLowerCase();
			if (text.endsWith("/b-")) {
				console.log("begin");
			} else if (text.endsWith("/i")) {
				console.log("interval");
			}
		}
	}

	function getSelectionEnd(o) {
		if (o.createTextRange) {
			var r = document.selection.createRange().duplicate();
			r.moveStart('character', -o.value.length);
			return r.text.length;
		} else return o.selectionEnd;
	}
	</script>

	<label class="context-menu-one" for="utterance">Utterance
	<input type="text" id="utterance" name="utterance" onkeyup="onTextChanged()">
</body>

</html>
